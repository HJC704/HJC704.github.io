{% assign project = include.project | default: site.data.featured_project %}
{% if project and project.enabled != false %}
  <section class="home-project-section">
    <h2 class="home-project-section__title">Project</h2>

    <div class="home-featured-project">
      {% if project.image %}
        {% assign image_raw = project.image | strip %}
        {% assign image_alt = project.image_alt | default: project.title %}
        {% assign is_external_image = image_raw contains '://' %}
        {% assign image_ext = image_raw | split: '?' | first | split: '.' | last | downcase %}

        <div class="home-featured-project__media">
          {% if image_ext == 'gif' %}
            {% if image_raw contains '/' %}
              <img src="{{ image_raw | relative_url }}" alt="{{ image_alt }}" loading="lazy" class="home-featured-project__image">
            {% else %}
              <img
                src="{{ '/assets/img/' | append: image_raw | relative_url }}"
                alt="{{ image_alt }}"
                loading="lazy"
                class="home-featured-project__image"
              >
            {% endif %}
          {% elsif is_external_image %}
            <img src="{{ image_raw }}" alt="{{ image_alt }}" loading="lazy" class="home-featured-project__image">
          {% else %}
            {% if image_raw contains '/' %}
              {% assign figure_path = image_raw %}
            {% else %}
              {% assign figure_path = 'assets/img/' | append: image_raw %}
            {% endif %}
            {% include figure.liquid path=figure_path loading="lazy" class="home-featured-project__image" alt=image_alt %}
          {% endif %}
        </div>
      {% endif %}

      <div class="home-featured-project__content">
        {% if project.title %}
          <h3 class="home-featured-project__name">{{ project.title }}</h3>
        {% endif %}

        {% if project.subtitle or project.highlight_name %}
          <p class="home-featured-project__subtitle">
            {% if project.highlight_name -%}
              <strong>{{ project.highlight_name }}</strong>
            {%- endif %}
            {% if project.subtitle -%}
              {%- if project.highlight_name %}, {% endif -%}
              {{- project.subtitle -}}
            {%- endif %}
          </p>
        {% endif %}

        {% if project.role %}
          <p class="home-featured-project__role">
            <em>{{ project.role }}</em>
          </p>
        {% endif %}

        {% if project.description %}
          <p class="home-featured-project__description">{{ project.description }}</p>
        {% endif %}

        {% if project.links %}
          <div class="home-featured-project__links">
            {% for link in project.links %}
              <a
                class="home-featured-project__link"
                href="{{ link.url }}"
                {% if link.external != false %}
                  target="_blank" rel="noopener"
                {% endif %}
              >
                [{{ link.label }}]
              </a>
            {% endfor %}
          </div>
        {% endif %}
      </div>
    </div>
  </section>
{% endif %}
